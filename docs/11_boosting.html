<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.21">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Boosting – Data Science Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea1d7ac60288e0f1efdbc993fd8432ae.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-e31584831b205ffbb2d98406f31c2a5b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Data Science Project</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./01_introduction.html"> 
<span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-dataprepeda" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">DataPrep/EDA</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-dataprepeda">    
        <li>
    <a class="dropdown-item" href="./02_01_overview.html">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./02_02_data_gathering_and_cleaning.html">
 <span class="dropdown-text">Data Gathering and Data Cleaning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./02_03_data_visualization.html">
 <span class="dropdown-text">Data Visualization</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-modelmethod" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Model/Method</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-modelmethod">    
        <li>
    <a class="dropdown-item" href="./03_clustering.html">
 <span class="dropdown-text">Clustering</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./04_pca.html">
 <span class="dropdown-text">Principal Component Analysis (PCA)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./05_naive_bayes.html">
 <span class="dropdown-text">Naïve Bayes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./06_decision_trees.html">
 <span class="dropdown-text">Decision Trees</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./11_boosting.html">
 <span class="dropdown-text">Boosting</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./12_results.html"> 
<span class="menu-text">Results</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./13_project_challenges.html"> 
<span class="menu-text">Project Challenges</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./10_conclusions.html"> 
<span class="menu-text">Conclusions</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/taso5789/ds-project-portfolio"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/taihei-sone-586102253/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#data-prep" id="toc-data-prep" class="nav-link" data-scroll-target="#data-prep">Data Prep</a>
  <ul class="collapse">
  <li><a href="#training-and-test-data-for-yoy-inflation-prediction" id="toc-training-and-test-data-for-yoy-inflation-prediction" class="nav-link" data-scroll-target="#training-and-test-data-for-yoy-inflation-prediction">Training and Test Data for YoY Inflation Prediction</a></li>
  <li><a href="#training-and-test-data-for-mom-inflation-prediction" id="toc-training-and-test-data-for-mom-inflation-prediction" class="nav-link" data-scroll-target="#training-and-test-data-for-mom-inflation-prediction">Training and Test Data for MoM Inflation Prediction</a></li>
  <li><a href="#training-and-test-data-for-unemployment-rates" id="toc-training-and-test-data-for-unemployment-rates" class="nav-link" data-scroll-target="#training-and-test-data-for-unemployment-rates">Training and Test Data for Unemployment Rates</a></li>
  </ul></li>
  <li><a href="#code" id="toc-code" class="nav-link" data-scroll-target="#code">Code</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a>
  <ul class="collapse">
  <li><a href="#confusion-matrix-for-yoy-inflation-prediction" id="toc-confusion-matrix-for-yoy-inflation-prediction" class="nav-link" data-scroll-target="#confusion-matrix-for-yoy-inflation-prediction">Confusion Matrix for YoY Inflation Prediction</a></li>
  <li><a href="#confusion-matrix-for-mom-inflation-prediction" id="toc-confusion-matrix-for-mom-inflation-prediction" class="nav-link" data-scroll-target="#confusion-matrix-for-mom-inflation-prediction">Confusion Matrix for MoM Inflation Prediction</a></li>
  <li><a href="#confusion-matrix-for-unemployment-rates-prediction" id="toc-confusion-matrix-for-unemployment-rates-prediction" class="nav-link" data-scroll-target="#confusion-matrix-for-unemployment-rates-prediction">Confusion Matrix for Unemployment Rates Prediction</a></li>
  </ul></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Boosting</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="overview" class="level1">
<h1>Overview</h1>
<div class="justify">
<ul>
<li><p>Ensemble learning refers to methods that combine multiple models to achieve higher predictive accuracy than any single model could provide. Among ensemble techniques, boosting is a powerful approach that builds a strong predictive model by sequentially adding many weak learners. A weak learner is a simple model—often a shallow decision tree—that performs only slightly better than random guessing. Although each weak learner has limited predictive capability, boosting improves overall performance by allowing each new learner to correct the errors of the previous ones.</p></li>
<li><p>Boosting operates through an iterative refinement process. Each weak learner focuses on the mistakes made by the ensemble so far, gradually reducing both bias and variance. In early iterations, boosting decreases bias by adding learners that capture patterns missed by prior models. Later iterations refine the decision boundaries more carefully, with learning-rate regularization preventing excessive variance or overfitting.</p></li>
</ul>
<section id="differences-between-adaboost-gradient-boosting-and-xgboost" class="level3">
<h3 class="anchored" data-anchor-id="differences-between-adaboost-gradient-boosting-and-xgboost">Differences Between AdaBoost, Gradient Boosting, and XGBoost</h3>
<ul>
<li><strong>AdaBoost</strong>
<ul>
<li>Adjusts the weights of individual samples based on whether they were misclassified.</li>
<li>Misclassified samples receive higher weights so the next learner focuses on harder cases.</li>
<li>Works especially well for classification with simple decision stumps or shallow trees.</li>
</ul></li>
<li><strong>Gradient Boosting</strong>
<ul>
<li>Each new learner fits the residuals (errors) of the previous model.</li>
<li>Uses gradient descent on the loss function, allowing flexibility for regression or classification.</li>
<li>Each tree incrementally improves the prediction by reducing the remaining error.</li>
</ul></li>
<li><strong>XGBoost</strong>
<ul>
<li>An optimized and regularized version of Gradient Boosting.</li>
<li>Incorporates L1/L2 regularization to control model complexity.</li>
<li>Includes system-level optimizations such as parallelization, sparse-aware learning, and efficient tree-splitting algorithms.</li>
<li>Known for high speed and state-of-the-art performance on large datasets.</li>
</ul></li>
</ul>
</section>
<section id="concepts-bias-variance-and-iterative-error-reduction" class="level3">
<h3 class="anchored" data-anchor-id="concepts-bias-variance-and-iterative-error-reduction">Concepts: Bias, Variance, and Iterative Error Reduction</h3>
<ul>
<li>Boosting reduces bias by adding learners that progressively capture more structure in the data. Learning rate regulates how strongly each new learner influences the ensemble, helping prevent overfitting. As more learners are added, the ensemble can represent increasingly complex relationships, but careful tuning of hyperparameters is necessary to control variance.</li>
</ul>
</section>
<section id="weighting-samples-and-minimizing-residuals" class="level3">
<h3 class="anchored" data-anchor-id="weighting-samples-and-minimizing-residuals">Weighting Samples and Minimizing Residuals</h3>
<ul>
<li>Boosting emphasizes improvement on the model’s weaknesses:
<ul>
<li>AdaBoost increases the weights of misclassified samples.</li>
<li>Gradient Boosting models the residuals directly.</li>
<li>XGBoost further optimizes residual fitting through second-order gradient information and regularization.</li>
</ul></li>
<li>These mechanisms ensure that each iteration focuses on the most informative parts of the error landscape.</li>
</ul>
</section>
<section id="key-hyperparameters" class="level3">
<h3 class="anchored" data-anchor-id="key-hyperparameters">Key Hyperparameters</h3>
<ul>
<li><p><strong>Learning Rate</strong><br>
Controls the contribution of each weak learner. Lower values improve generalization but require more estimators.</p></li>
<li><p><strong>Number of Estimators</strong><br>
Determines how many weak learners are combined. More estimators increase model capacity but may lead to overfitting if not balanced.</p></li>
<li><p><strong>Tree Depth</strong><br>
Controls the complexity of each weak learner. Shallow trees reduce variance, while deeper trees capture more structure but risk overfitting.</p></li>
</ul>
</section>
</div>
<div class="justify">
<div class="columns">
<div class="column" style="width:46%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/fig_11_overview_01.jpg" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Schematic diagram showing the concept of ensemble learning. Source: <a href="https://doi.org/10.1007/s40515-025-00628-2" target="_blank">Tiwari, S., Das, S. Explainable Artificial Intelligence-Driven Ensemble Learning for Liquefaction Susceptibility Analysis. Transp. Infrastruct. Geotech. 12, 171 (2025).</a></figcaption>
</figure>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:49%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/fig_11_overview_02.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Illustration of gradient descent and its continuous surrogate gradient flow. Source: <a href="https://www.offconvex.org/2022/01/06/gf-gd/" target="_blank">Nadav Cohen, Does Gradient Flow Over Neural Networks Really Represent Gradient Descent? (2022).</a></figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="data-prep" class="level1">
<h1>Data Prep</h1>
<div class="justify">
<ul>
<li>The sample image of the data used in the analysis on this page is shown below. This dataset corresponds to the one shown in “Merged Cleaned Data” at the end of <a href="./02_02_data_gathering_and_cleaning.html">Data Gathering and Data Cleaning</a>. The dataset can be found <a href="https://github.com/taso5789/ds-project-portfolio/tree/main/data/df_merged.csv">here</a>.
<ul>
<li>For this analysis, the target variables—inflation rates (<code>PCEPILFE_YoY</code>, <code>PCEPILFE_MoM</code>) and the unemployment rate (<code>UNRATE</code>)—were binarized to apply the boosting. The historical median of each variable was used as a threshold; periods with values above the median were defined as “High Inflation” or “High Unemployment” (1), and all others as “Low” (0).</li>
</ul></li>
</ul>
<div class="text-center">
<p><img src="results/11_Boosting/data.jpg" class="img-fluid" style="width:100.0%"></p>
</div>
<ul>
<li><p>The training and testing data must be <strong>disjoint</strong> sets, meaning they have no data points in common. The reason is to get an honest evaluation of the model’s ability to generalize to new, unseen data. If the sets overlap, the model is being tested on data it has already “seen” during training, which would be like giving a student an exam with questions they had already memorized. Keeping the training and testing sets <strong>disjoint</strong> is the only way to get a true measure of the model’s predictive performance.</p></li>
<li><p>The training and testing data used to predict the year-over-year (YoY) inflation (<code>high_inflation_YoY</code> derived from <code>PCEPILFE_YoY</code>), month-over-month (MoM) inflation (<code>high_inflation_MoM</code> derived from <code>PCEPILFE_MoM</code>), and unemployment rates (<code>high_unemployment</code> derived from <code>UNRATE</code>) are shown in <a href="#fig-inf-YoY-train" class="quarto-xref">Figure&nbsp;1</a> ~ <a href="#fig-unemp-test" class="quarto-xref">Figure&nbsp;6</a>, respectively.</p></li>
</ul>
</div>
<section id="training-and-test-data-for-yoy-inflation-prediction" class="level2">
<h2 class="anchored" data-anchor-id="training-and-test-data-for-yoy-inflation-prediction">Training and Test Data for YoY Inflation Prediction</h2>
<div class="justify">
<ol type="1">
<li><p><strong>Defining Predictors and Target</strong>: The binarized YoY inflation rate (<code>high_inflation_YoY</code>) was set as the target variable (y). All other potential target variables regarding inflation and unemployment were excluded from the feature set (X) to prevent data leakage.</p></li>
<li><p><strong>Data Splitting</strong>: The dataset was divided into a <strong>70% training set</strong> and a <strong>30% testing set</strong> using stratified sampling to ensure the class proportions were identical in both sets.</p></li>
<li><p><strong>Selective Scaling</strong>: <strong>Only continuous variables were standardized</strong> using <code>StandardScaler</code>, while dummy variables (e.g., for recessions) were excluded from this process. The scaler was fit on the training data and then applied to the test data to prevent data leakage.</p></li>
</ol>
</div>
<div class="justify">
<div class="columns">
<div class="column" style="width:47.5%;">
<div id="fig-inf-YoY-train" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-inf-YoY-train-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="results/11_Boosting/inflation_YoY_train_data.jpg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-inf-YoY-train-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: The Training Data for YoY Inflation
</figcaption>
</figure>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:47.5%;">
<div id="fig-inf-YoY-test" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-inf-YoY-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="results/11_Boosting/inflation_YoY_test_data.jpg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-inf-YoY-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: The Test Data for YoY Inflation
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="training-and-test-data-for-mom-inflation-prediction" class="level2">
<h2 class="anchored" data-anchor-id="training-and-test-data-for-mom-inflation-prediction">Training and Test Data for MoM Inflation Prediction</h2>
<div class="justify">
<ol type="1">
<li><p><strong>Defining Predictors and Target</strong>: The binarized MoM inflation rate (<code>high_inflation_MoM</code>) was set as the target variable (y). All other potential target variables regarding inflation and unemployment were excluded from the feature set (X) to prevent data leakage.</p></li>
<li><p><strong>Data Splitting</strong>: The dataset was divided into a <strong>70% training set</strong> and a <strong>30% testing set</strong> using stratified sampling to ensure the class proportions were identical in both sets.</p></li>
<li><p><strong>Selective Scaling</strong>: <strong>Only continuous variables were standardized</strong> using <code>StandardScaler</code>, while dummy variables (e.g., for recessions) were excluded from this process. The scaler was fit on the training data and then applied to the test data to prevent data leakage.</p></li>
</ol>
</div>
<div class="justify">
<div class="columns">
<div class="column" style="width:47.5%;">
<div id="fig-inf-MoM-train" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-inf-MoM-train-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="results/11_Boosting/inflation_MoM_train_data.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-inf-MoM-train-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: The Training Data for MoM Inflation
</figcaption>
</figure>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:47.5%;">
<div id="fig-inf-MoM-test" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-inf-MoM-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="results/11_Boosting/inflation_MoM_test_data.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-inf-MoM-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: The Test Data for MoM Inflation
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="training-and-test-data-for-unemployment-rates" class="level2">
<h2 class="anchored" data-anchor-id="training-and-test-data-for-unemployment-rates">Training and Test Data for Unemployment Rates</h2>
<div class="justify">
<ol type="1">
<li><p><strong>Defining Predictors and Target</strong>: The binarized unemployment rate (<code>high_unemployment</code>) was set as the target variable (y). All other potential target variables regarding inflation and unemployment were excluded from the feature set (X) to prevent data leakage.</p></li>
<li><p><strong>Data Splitting</strong>: The dataset was divided into a <strong>70% training set</strong> and a <strong>30% testing set</strong> using stratified sampling to ensure the class proportions were identical in both sets.</p></li>
<li><p><strong>Selective Scaling</strong>: <strong>Only continuous variables were standardized</strong> using <code>StandardScaler</code>, while dummy variables (e.g., for recessions) were excluded from this process. The scaler was fit on the training data and then applied to the test data to prevent data leakage.</p></li>
</ol>
</div>
<div class="justify">
<div class="columns">
<div class="column" style="width:47.5%;">
<div id="fig-unemp-train" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-unemp-train-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="results/11_Boosting/unemp_train_data.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-unemp-train-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: The Training Data for Unemployment Rates
</figcaption>
</figure>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:47.5%;">
<div id="fig-unemp-test" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-unemp-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="results/11_Boosting/unemp_test_data.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-unemp-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: The Test Data for Unemployment Rates
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="code" class="level1">
<h1>Code</h1>
<div class="justify">
<ul>
<li>For the code used in this chapter (Boosting), please refer <a href="https://github.com/taso5789/ds-project-portfolio/blob/main/code/6_Boosting.ipynb">here</a>.</li>
</ul>
</div>
</section>
<section id="results" class="level1">
<h1>Results</h1>
<div class="justify">
<ul>
<li><p>To evaluate how different hyperparameter configurations affect model performance, three XGBoost models—Model A, Model B, and Model C—were trained and compared. These models vary in model depth, number of boosting rounds, learning rate, and sampling ratios, allowing for a systematic assessment of the bias–variance trade-off.</p>
<ul>
<li><p><strong>Model A</strong> is designed as a balanced and stable baseline, with moderate tree depth and a standard learning rate that avoids excessive complexity.</p></li>
<li><p><strong>Model B</strong> increases both the number and depth of trees, enhancing the model’s capacity to capture nonlinear patterns but potentially raising the risk of overfitting.</p></li>
<li><p><strong>Model C</strong> uses shallower trees combined with a higher learning rate, creating a lightweight model that emphasizes generalization through increased bias.</p></li>
</ul></li>
</ul>
<section id="model-parameter-summary" class="level3" style="text-align: center;">
<h3 class="anchored" data-anchor-id="model-parameter-summary">Model Parameter Summary</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 13%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>n_estimators</th>
<th>max_depth</th>
<th>learning_rate</th>
<th>subsample</th>
<th>colsample_bytree</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Model A</strong></td>
<td>200</td>
<td>3</td>
<td>0.05</td>
<td>0.8</td>
<td>0.8</td>
</tr>
<tr class="even">
<td><strong>Model B</strong></td>
<td>300</td>
<td>4</td>
<td>0.03</td>
<td>0.7</td>
<td>0.9</td>
</tr>
<tr class="odd">
<td><strong>Model C</strong></td>
<td>150</td>
<td>2</td>
<td>0.1</td>
<td>0.9</td>
<td>0.7</td>
</tr>
</tbody>
</table>
</section>
<ul>
<li>These three configurations enable a structured comparison of performance metrics such as accuracy, confusion matrices, and feature importance across varying model complexities.</li>
</ul>
</div>
<section id="confusion-matrix-for-yoy-inflation-prediction" class="level2">
<h2 class="anchored" data-anchor-id="confusion-matrix-for-yoy-inflation-prediction">Confusion Matrix for YoY Inflation Prediction</h2>
<div class="justify">
<ul>
<li><p>The three XGBoost models show broadly similar patterns in their confusion matrices. All models classify low-inflation periods with high accuracy, correctly identifying 33 out of 35 observations. The main differences arise in their ability to detect high-inflation periods. Model C performs best, correctly identifying 27 out of 35 high-inflation months, followed by Model A (26/35) and Model B (25/35). This indicates that Model C offers the most balanced performance across both classes, while Model A and Model B tend to slightly underpredict high-inflation episodes.</p></li>
<li><p>The feature importance results show that a few macroeconomic indicators are particularly influential in predicting high-inflation periods. The federal funds rate (<code>FEDFUNDS</code>) is consistently the strongest predictor across all models. Average Hourly Earnings of All Employees, Total Private (<code>CES0500000003</code>), 1-Year Expected Changes in Inflation Rates (<code>PX_MD</code>), and Real Potential GDP (<code>GDPPOT</code>) also rank highly. These variables capture wage pressures, inflation expectations, and long-run economic capacity—factors closely tied to inflation dynamics. Although minor differences appear across models, the same key predictors consistently dominate, indicating stable and robust signals.</p></li>
</ul>
</div>
<div class="justify">
<div class="columns">
<div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results/11_Boosting/cm_inf_YoY_model_A.jpg" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Confusion Matrix of Model A</figcaption>
</figure>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results/11_Boosting/cm_inf_YoY_model_B.jpg" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Confusion Matrix of Model B</figcaption>
</figure>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results/11_Boosting/cm_inf_YoY_model_C.jpg" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Confusion Matrix of Model C</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="justify">
<div class="columns">
<div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results/11_Boosting/fi_inf_YoY_Model_A.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Feature Importance of Model A</figcaption>
</figure>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results/11_Boosting/fi_inf_YoY_Model_B.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Feature Importance of Model B</figcaption>
</figure>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results/11_Boosting/fi_inf_YoY_Model_C.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Feature Importance of Model C</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="confusion-matrix-for-mom-inflation-prediction" class="level2">
<h2 class="anchored" data-anchor-id="confusion-matrix-for-mom-inflation-prediction">Confusion Matrix for MoM Inflation Prediction</h2>
<div class="justify">
<ul>
<li><p>The three XGBoost models exhibit broadly similar patterns in their confusion matrices for MoM inflation prediction. Overall performance is weaker than in the YoY setting, reflecting the higher volatility and noise in month-to-month inflation changes. Model B performs best, correctly identifying 24 low-inflation and 21 high-inflation observations. Model C performs moderately, while Model A yields the weakest results. All three models misclassify a sizable number of observations in both directions, indicating that MoM inflation is inherently more difficult to predict using the available macroeconomic indicators.</p></li>
<li><p>The feature importance results similarly highlight a small set of dominant predictors. The noncyclical rate of unemployment (<code>NROU</code>) and the federal funds rate (<code>FEDFUNDS</code>) consistently appear as the most influential variables, followed by import prices (<code>IR</code>), labor-market participation measures (<code>CIVPART</code>), real potential GDP (<code>GDPPOT</code>), and the money supply (<code>M2SL</code>). These indicators capture labor-market slack, monetary policy stance, and real-economic conditions, all of which contribute to explaining rapid month-to-month inflation movements. As with the YoY model, the ranking differs slightly across specifications, but the central macroeconomic drivers remain stable and robust.</p></li>
</ul>
</div>
<div class="justify">
<div class="columns">
<div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results/11_Boosting/cm_inf_MoM_model_A.jpg" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Confusion Matrix of Model A</figcaption>
</figure>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results/11_Boosting/cm_inf_MoM_model_B.jpg" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Confusion Matrix of Model B</figcaption>
</figure>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results/11_Boosting/cm_inf_MoM_model_C.jpg" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Confusion Matrix of Model C</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="justify">
<div class="columns">
<div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results/11_Boosting/fi_inf_MoM_Model_A.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Feature Importance of Model A</figcaption>
</figure>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results/11_Boosting/fi_inf_MoM_Model_B.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Feature Importance of Model B</figcaption>
</figure>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results/11_Boosting/fi_inf_MoM_Model_C.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Feature Importance of Model C</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="confusion-matrix-for-unemployment-rates-prediction" class="level2">
<h2 class="anchored" data-anchor-id="confusion-matrix-for-unemployment-rates-prediction">Confusion Matrix for Unemployment Rates Prediction</h2>
<div class="justify">
<ul>
<li><p>The confusion matrices for the unemployment prediction models show that all three XGBoost configurations achieve very high and nearly identical performance. Each model correctly classifies almost all observations in both categories, with only three high-unemployment months misclassified as low. As a result, all models attain the same accuracy of 0.9571, indicating that the underlying features provide strong and stable signals for distinguishing between low- and high-unemployment periods.</p></li>
<li><p>The feature importance results highlight a consistent set of dominant predictors across models. Average Hourly Earnings of All Employees, Total Private (<code>CES0500000003</code>), 1-Year Expected Changes in Inflation Rates (<code>PX_MD</code>), and the 10-Year Breakeven Inflation Rate (<code>T10YIE</code>) appear as the most influential variables, followed by monetary and real-activity indicators such as the total assets of Federal Reserve (<code>WALCL</code>), the federal funds rate (<code>FEDFUNDS</code>), and industrial production (<code>INDPRO</code>). These features collectively capture labor market conditions, price expectations, interest rate dynamics, and broader economic activity. Although minor differences appear across models, the same key predictors consistently dominate, indicating stable and robust signals.</p></li>
</ul>
</div>
<div class="justify">
<div class="columns">
<div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results/11_Boosting/cm_unemp_model_A.jpg" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Confusion Matrix of Model A</figcaption>
</figure>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results/11_Boosting/cm_unemp_model_B.jpg" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Confusion Matrix of Model B</figcaption>
</figure>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results/11_Boosting/cm_unemp_model_C.jpg" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Confusion Matrix of Model C</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="justify">
<div class="columns">
<div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results/11_Boosting/fi_unemp_Model_A.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Feature Importance of Model A</figcaption>
</figure>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results/11_Boosting/fi_unemp_Model_B.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Feature Importance of Model B</figcaption>
</figure>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results/11_Boosting/fi_unemp_Model_C.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Feature Importance of Model C</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="conclusions" class="level1">
<h1>Conclusions</h1>
<div class="justify">
<ul>
<li><p>The boosting models revealed clear patterns in the inflation and unemployment data. Across tasks, boosting helped capture nonlinear interactions among macroeconomic variables and produced stable and interpretable results. The models consistently highlighted the importance of monetary policy indicators and labor market conditions in predicting inflation regimes, while unemployment classifications were highly accurate across all parameter settings.</p></li>
<li><p>The comparison of hyperparameters showed that model performance is sensitive to the chosen level of complexity. Moderate tree depth and learning rates often provided a good balance between capturing relevant structure and avoiding overfitting, though deeper trees performed best in a few cases—particularly for the more volatile month-to-month inflation predictions. This suggests that the optimal hyperparameter configuration depends on the characteristics of each prediction task.</p></li>
<li><p>Future improvements could include using cross-validation for more reliable model selection, applying alternative boosting algorithms such as LightGBM or CatBoost, and incorporating SHAP values to better explain individual feature contributions. Expanding the feature set or integrating time-series-oriented methods may further strengthen predictive performance, especially for high-frequency outcomes like MoM inflation.</p></li>
</ul>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/taso5789\.github\.io\/ds-project-portfolio\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>